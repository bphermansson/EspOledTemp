<!DOCTYPE html>
<html>
<head>
  <title>EspOledTemp</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="data:,">
  <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
  <div class="container">
    <h1><span id="appname"></span></h1>
    <!--<p>Json data: <strong> %STATE%</strong></p>
    <p><button class="data" id="temp">NA</button></p>
    <span id="temp">NA</span>
    <p><button class="data data2">OFF</button></p>-->
  <!--
  <div>
      Data : <span id="data">NA</span>
  </div>
  -->
  <div id="values">
  
    <b><span id="timekey"></span></b>
      <br />
      <span id="time"></span>
  </div>
  <div id="values">
      <b><span id="datekey"></span></b><br />
      <span id="date"></span>
  </div>
  <div id="values">
      <b><span id="tempkey"></span></b><br />
      <span id="temperature"></span>
  </div>
  <div id="values">
      <b><span id="humkey"></span></b><br />
      <span id="humidity"></span>
  </div>
  <div id="values">
      <b><span id="uptimekey"></span></b><br />
      <span id="uptime"></span>
  </div>
</div>
<!--
<div class="container">
    <div class="child">Child One</div>
    <div class="child">Child Two</div>
  </div>
-->
<script>
setInterval(function() {
  // Call a function repetatively with 2 Second interval
  getData();
}, 2000); //2000mSeconds update rate

function getData() {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      //document.getElementById("data").innerHTML = this.responseText;
      
      let obj = JSON.parse(this.responseText.toString());
      var keys = Object.keys(obj);

      document.getElementById("appname").innerHTML = obj.appname;
      
      document.getElementById("timekey").innerHTML = capitalizeFirstLetter(keys[ 1 ]);
      document.getElementById("time").innerHTML = obj.time;
      
      document.getElementById("datekey").innerHTML = capitalizeFirstLetter(keys[ 2 ]);
      document.getElementById("date").innerHTML = obj.date;

      document.getElementById("tempkey").innerHTML = capitalizeFirstLetter(keys[ 3 ]);
      document.getElementById("temperature").innerHTML = obj.temperature;

      document.getElementById("humkey").innerHTML = capitalizeFirstLetter(keys[ 4 ]);
      document.getElementById("humidity").innerHTML = obj.humidity;

      document.getElementById("uptimekey").innerHTML = capitalizeFirstLetter(keys[ 5 ]);
      document.getElementById("uptime").innerHTML = obj.uptime;

    }
  };
  xhttp.open("GET", "readdata", true);
  xhttp.send();
}

function capitalizeFirstLetter(string) {
    return string.charAt(0).toUpperCase() + string.slice(1);
}

</script>
</body>
</html>
